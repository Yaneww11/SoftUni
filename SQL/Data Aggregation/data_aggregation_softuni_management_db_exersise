-- 01 
SELECT 
	count(CASE department_id WHEN 1 THEN 1 end) as "Engineering",
	count(CASE department_id WHEN 2 THEN 1 end) as "Tool Design",
	count(CASE department_id WHEN 3 THEN 1 end) as "Sales",
	count(CASE department_id WHEN 4 THEN 1 end) as "Marketing",
	count(CASE department_id WHEN 5 THEN 1 end) as "Purchasing",
	count(CASE department_id WHEN 6 THEN 1 end) as "Research and Development",
	count(CASE department_id WHEN 7 THEN 1 end) as "Production"
FROM employees
	;

-- 02 
UPDATE employees
SET salary =
	CASE
		WHEN hire_date < '2015-01-16' THEN salary + 2500
		WHEN hire_date < '2020-03-04' THEN salary + 1500
		ELSE salary
	END,
job_title = 
	CASE
		WHEN hire_date < '2015-01-16' THEN concat('Senior ', job_title)
		WHEN hire_date < '2020-03-04' THEN concat('Mid-', job_title)
		ELSE job_title
	END
RETURNING *
;
